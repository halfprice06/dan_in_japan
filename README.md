# Vacation Photos Website

A personal website that hosts vacation photos with AI-generated captions and an interactive map.

## Features

- **AI-Generated Captions**: Uses the Anthropic Claude API to generate captions for each photo.
- **Interactive Map**: Displays photos on an interactive map based on GPS metadata.
- **Sorting and Filtering**: Allows sorting photos by date and searching by location.
- **Responsive Design**: Accessible and user-friendly across devices.
- **Customizable Prompts**: Configure how captions are generated by customizing the system prompt.
- **Automatic Database Setup**: The database is automatically set up when processing images.

## Setup Instructions

1. **Clone the repository:**
   ```bash
   git clone https://github.com/halfprice06/dan_in_japan.git
   cd dan_in_japan
   ```

2. **Create a virtual environment:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows use `venv\Scripts\activate`
   ```

3. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Set up environment variables:**

   - Copy the `.env.template` file to `.env`:
     ```bash
     cp .env.template .env
     ```
     
   - Open `.env` and fill in your API keys and customize the `SYSTEM_PROMPT` as needed:
     ```env
     ANTHROPIC_API_KEY=your_anthropic_api_key
     SERP_API_KEY=your_serpapi_key
     SYSTEM_PROMPT=your_customized_prompt
     ```
   
   The `SYSTEM_PROMPT` is crucial for generating accurate captions. It should include:
   - Context about the trip and travelers.
   - Specific instructions for the AI on how to generate captions.
   - The `{photographer}` placeholder, which will be replaced with the photographer's name during processing.

   **Example `SYSTEM_PROMPT`:**
   ```
   You are creating captions for a travel blog called 'Dan in Japan' about a vacation taken by Dan, Christina, Chuck, and Ashley in October 2024. You are being given a photo from the trip along with a screenshot of a map showing where the photo was taken using the SerpAPI from the photo coordinates. Write a caption for this photo in the style of a modern travel blog, as if you're sharing this moment with a friend who's never been to Japan. About the travelers: Dan (the author), Christina (Dan's wife), Chuck (friend), and Ashley (friend). Trip details:
   
   - Spent 2 weeks in Japan during October 2024
   - Visited Tokyo, Osaka, and Kyoto
   - Accommodations: stayed in a mix of hotels and traditional ryokans
   - This photo was taken by {photographer}.
   
   **The caption should:**
   - Feel conversational and personal, not academic
   - Include relevant cultural/historical context only if it adds to the story
   - Capture the mood or feeling of the moment
   - Use present tense to make it immediate ("Here's Dan checking out..." vs "Dan checked out...")
   - Include specific details from the photo but avoid over-describing
   - Keep it to 1-2 engaging sentences
   
   **Don't:**
   - Make assumptions about anything in the photo
   - Add fictional details or imagine backstories
   - Describe things not visible in the photo
   - Assume activities from map locations were done
   - For photos from the home country (pre/post trip), you are likely looking at prizes/souvenirs brought home. When looking at the map, don't assume whatever shows on the map is the activity from the photo; that's just to show what was nearby. If the photo is from the home country, it's from before/after the trip.
   ```

5. **Organize your photos:**

   - Place your photos in the `photos` directory.
   - Optionally, create subdirectories in the `photos` directory for each photographer.
   - The name of each subdirectory will be used as the photographer's name.
   - Example structure:
     ```
     photos/
     ├── Chuck/
     │   ├── temple.jpg
     │   └── garden.jpg
     ├── Ashley/
     │   ├── market.jpg
     │   └── shrine.jpg
     ├── dan_photo1.jpg
     ├── christina_photo2.jpg
     ```

6. **Process images and generate captions:**
   ```bash
   python process_images.py
   ```

   - This script will:
     - Extract EXIF data from your photos.
     - Generate captions using the Anthropic API based on your `SYSTEM_PROMPT`.
     - Retrieve location names using the GPS data.
     - Generate map images using the SerpAPI.
     - Store the photo data in the SQLite database.

7. **Run the application:**
   ```bash
   uvicorn app:app --reload
   ```

   - Access the website at `http://localhost:8000`.

## Project Structure

- `app.py`: The main FastAPI application.
- `process_images.py`: Script to process images and generate captions.
- `setup_database.py`: Script to set up the SQLite database.
- `templates/`: Contains the Jinja2 templates for the web pages.
- `static/`: Contains static files like CSS, JavaScript, and images.
- `photos/`: Place your photos here to be processed.
- `requirements.txt`: Python dependencies required for the project.
- `.env.template`: Template for the environment variables.
- `README.md`: Documentation and setup instructions.

## Dependencies

- **Python Packages:**
  - Python 3.x
  - FastAPI
  - Pillow (PIL)
  - `anthropic` SDK
  - `serpapi` SDK
  - `python-dotenv`
  - `uvicorn`
  - `Jinja2`

- **JavaScript and CSS Libraries (Included via CDN):**
  - Leaflet.js and Leaflet.markercluster plugin
  - Tailwind CSS

## License

This project is licensed under the MIT License. 